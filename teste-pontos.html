<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste de Carregamento de Pontos</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        .log {
            background: #f5f5f5;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .success { color: #28a745; }
        .error { color: #dc3545; }
        .warning { color: #ffc107; }
        .info { color: #17a2b8; }
    </style>
</head>
<body>
    <h1>Teste de Carregamento de Pontos - SIG Entretenimento DF</h1>
    
    <div id="status">Iniciando testes...</div>
    
    <h2>Logs de Teste:</h2>
    <div id="logs"></div>
    
    <h2>Resultado:</h2>
    <div id="resultado"></div>

    <script>
        function log(message, type = 'info') {
            const logs = document.getElementById('logs');
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logs.appendChild(div);
            console.log(message);
        }

        async function testarCarregamentoPontos() {
            try {
                log('Iniciando teste de carregamento de pontos...', 'info');
                
                // Teste 1: Verificar se arquivo JSON est√° acess√≠vel
                log('Teste 1: Verificando arquivo pontos_confirmados.json...', 'info');
                
                try {
                    const response = await fetch('./database/pontos_confirmados.json');
                    if (response.ok) {
                        const data = await response.json();
                        log(`‚úÖ Arquivo JSON carregado com sucesso: ${data.length} pontos`, 'success');
                        
                        // Mostrar alguns exemplos
                        if (data.length > 0) {
                            log(`üìç Exemplos de pontos:`, 'info');
                            data.slice(0, 3).forEach(ponto => {
                                log(`  - ${ponto.nome} (${ponto.categoria}) - ${ponto.coordenadas}`, 'info');
                            });
                        }
                        
                        return data;
                    } else {
                        log(`‚ùå Erro HTTP: ${response.status} - ${response.statusText}`, 'error');
                        return null;
                    }
                } catch (error) {
                    log(`‚ùå Erro ao carregar arquivo JSON: ${error.message}`, 'error');
                    return null;
                }
                
            } catch (error) {
                log(`‚ùå Erro geral no teste: ${error.message}`, 'error');
                return null;
            }
        }

        async function testarCategorias() {
            try {
                log('Teste 2: Verificando arquivo categorias.json...', 'info');
                
                const response = await fetch('./database/categorias.json');
                if (response.ok) {
                    const categorias = await response.json();
                    log(`‚úÖ Categorias carregadas: ${categorias.length}`, 'success');
                    
                    categorias.forEach(cat => {
                        log(`  - ${cat.nome} (${cat.id}): ${cat.cor}`, 'info');
                    });
                    
                    return categorias;
                } else {
                    log(`‚ùå Erro ao carregar categorias: ${response.status}`, 'error');
                    return null;
                }
            } catch (error) {
                log(`‚ùå Erro ao testar categorias: ${error.message}`, 'error');
                return null;
            }
        }

        async function executarTestes() {
            const status = document.getElementById('status');
            const resultado = document.getElementById('resultado');
            
            status.textContent = 'Executando testes...';
            
            const pontos = await testarCarregamentoPontos();
            const categorias = await testarCategorias();
            
            let resultadoTexto = '';
            let sucesso = true;
            
            if (pontos && pontos.length > 0) {
                resultadoTexto += `‚úÖ Pontos: ${pontos.length} carregados com sucesso\n`;
            } else {
                resultadoTexto += `‚ùå Falha ao carregar pontos\n`;
                sucesso = false;
            }
            
            if (categorias && categorias.length > 0) {
                resultadoTexto += `‚úÖ Categorias: ${categorias.length} carregadas com sucesso\n`;
            } else {
                resultadoTexto += `‚ùå Falha ao carregar categorias\n`;
                sucesso = false;
            }
            
            if (sucesso) {
                resultadoTexto += `\nüéâ TESTE CONCLU√çDO COM SUCESSO!\n`;
                resultadoTexto += `Os dados est√£o sendo servidos corretamente pelo servidor.`;
                status.textContent = 'Testes conclu√≠dos com sucesso!';
                status.style.color = '#28a745';
            } else {
                resultadoTexto += `\nüí• FALHAS DETECTADAS!\n`;
                resultadoTexto += `Verifique se o servidor est√° rodando e os arquivos existem.`;
                status.textContent = 'Falhas detectadas nos testes!';
                status.style.color = '#dc3545';
            }
            
            resultado.style.whiteSpace = 'pre-line';
            resultado.style.background = '#f8f9fa';
            resultado.style.padding = '15px';
            resultado.style.borderRadius = '4px';
            resultado.style.marginTop = '10px';
            resultado.textContent = resultadoTexto;
        }

        // Executar testes quando a p√°gina carregar
        window.addEventListener('load', executarTestes);
    </script>
</body>
</html>
